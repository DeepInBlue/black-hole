% --- adapted from https://gist.github.com/stefanozanella/8892211

% We are generating HTML + MathML code
\Preamble{xhtml,mathml}

% We don't want to translate font suggestions with ugly wrappers like
% <span class="cmti-10"> for italic text
\NoFonts
% Don't output xml version tag
\Configure{VERSION}{}

% Output HTML5 doctype instead of the default for HTML4
\Configure{DOCTYPE}{\HCode{<!doctype html>\Hnewline}}

% Custom page opening
\Configure{HTML}{\HCode{<html lang="en">\Hnewline}}{\HCode{\Hnewline</html>}}

% Setup custom <head> content
\Configure{@HEAD}{\HCode{<meta charset="UTF-8" />\Hnewline}}
\Configure{@HEAD}{\HCode{<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/\string~gurari/TeX4ht/)" />\Hnewline}}

% Setup MathJax
\Configure{@HEAD}{\HCode{<script type="text/x-mathjax-config">MathJax.Hub.Config({ TeX: { extensions: ["autobold.js"] }});</script>\Hnewline}}
\Configure{@HEAD}{\HCode{<script type="text/javascript"\Hnewline src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"\Hnewline></script>\Hnewline}}

% Custom style
\Configure{@HEAD}{\HCode{<link rel="stylesheet" type="text/css" href="physics-extras.css" />\Hnewline}}

% Translate \textbf, \textit and \texttt directives into <b>, <em> and <code>
\Configure{textbf}{\ifvmode\ShowPar\fi\HCode{<b>}}{\HCode{</b>}}
\Configure{textit}{\ifvmode\ShowPar\fi\HCode{<i>}}{\HCode{</i>}}
\Configure{emph}{\ifvmode\ShowPar\fi\HCode{<i>}}{\HCode{</i>}}
\Configure{texttt}{\ifvmode\ShowPar\fi\HCode{<code>}}{\HCode{</code>}}

% Translate verbatim and lstlisting blocks into <pre> elements
\ConfigureEnv{verbatim}{\HCode{<pre>}}{\HCode{</pre>}}{}{}
\ConfigureEnv{lstlisting}{\HCode{<pre>}}{\HCode{</pre>}}{}{}

% Do not set `indent`/`noindent` classes on paragraphs
\Configure{HtmlPar}
{\EndP\Tg<p>}
{\EndP\Tg<p>}
{\HCode{</p>\Hnewline}}
{\HCode{</p>\Hnewline}}

% Disable output of ligature symbols (fi, ff, ...)
\usepackage{microtype}
\DisableLigatures{encoding = *, family = * }

\begin{document}

% Work-around for boldsymbol, which does not seem to work in MathJAX
\renewcommand{\mb}{\mathbf}

\EndPreamble
